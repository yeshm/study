<!DOCTYPE HTML>
<html>
<head>
    <title>导出excel</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body>
<#include "/lv.html"/>
<!--<script type="text/javascript" src="//unpkg.com/xlsx/dist/shim.min.js"></script>-->
<!--<script type="text/javascript" src="//unpkg.com/xlsx/dist/xlsx.full.min.js"></script>-->
<script type="text/javascript" src="${request.contextPath}/js/shim.js"></script>
<script type="text/javascript" src="${request.contextPath}/js/xlsx.full.min.js"></script>
<script type="text/javascript" src="${request.contextPath}/js/excelHelper.js"></script>

<div style="text-align: center;margin: 100px;">
    <button type="button" onclick="exportExcel()">导出Excel</button>
    <button type="button" onclick="test()">测试</button>
</div>
<div id="previewDiv"></div>

<script type="text/javascript">
    var data = [
        {
            "offset": null,
            "pageNo": null,
            "pageSize": null,
            "id": null,
            "warehouseId": null,
            "whName": "821FionaNC仓库2",
            "whCode": "WH2321808002",
            "whStatus": null,
            "cityId": null,
            "goodsId": null,
            "specId": null,
            "createdTime": null,
            "createdTimeQuery": null,
            "goodsStatus": null,
            "specStatus": null,
            "specStatusText": "有效",
            "specName": "tom04（10个*1箱*冷藏*No）",
            "specCode": "GS01266-06",
            "goodsName": "tom04货物（仓库）",
            "brandName": "DHL品牌1",
            "largeClass": null,
            "largeClassName": "DHL大类11",
            "smallClass": null,
            "smallClassName": "DHL小类1",
            "recordMethod": null,
            "buyUnit": null,
            "buyUnitText": "箱",
            "purchaseUnit": null,
            "purchaseUnitText": "箱",
            "useUnit": null,
            "useUnitText": "个",
            "purchaseUseRatio": 10,
            "buyPurchaseRatio": 1,
            "goodsSpecUnifiedCode": "DHwu00040202006",
            "whIdGroups": null,
            "total": 0,
            "totalText": null,
            "totalBuy": 0,
            "totalDly": 0,
            "totalUse": 0,
            "available": 0,
            "availableText": null,
            "availableBuy": 0,
            "availableDly": 0,
            "availableUse": 0,
            "archive": 0,
            "archiveText": null,
            "archiveBuy": 0,
            "archiveDly": 0,
            "archiveUse": 0,
            "quarantine": 0,
            "quarantineText": null,
            "quarantineBuy": 0,
            "quarantineDly": 0,
            "quarantineUse": 0,
            "waitScrap": 0,
            "waitScrapText": null,
            "waitScrapBuy": 0,
            "waitScrapDly": 0,
            "waitScrapUse": 0,
            "scrap": 0,
            "scrapText": null,
            "scrapBuy": 0,
            "scrapDly": 0,
            "scrapUse": 0,
            "stockStatus": null
        },
        {
            "offset": null,
            "pageNo": null,
            "pageSize": null,
            "id": null,
            "warehouseId": null,
            "whName": "821FionaNC仓库2",
            "whCode": "WH2321808002",
            "whStatus": null,
            "cityId": null,
            "goodsId": null,
            "specId": null,
            "createdTime": null,
            "createdTimeQuery": null,
            "goodsStatus": null,
            "specStatus": null,
            "specStatusText": "有效",
            "specName": "tom02采购1万*1箱*冷冻*No",
            "specCode": "GS01258-01",
            "goodsName": "tom01货物（根据采购量配货）",
            "brandName": "Evan品牌",
            "largeClass": null,
            "largeClassName": "DHL大类11",
            "smallClass": null,
            "smallClassName": "DHL小类1",
            "recordMethod": null,
            "buyUnit": null,
            "buyUnitText": "箱",
            "purchaseUnit": null,
            "purchaseUnitText": "箱",
            "useUnit": null,
            "useUnitText": "毫克",
            "purchaseUseRatio": 10000,
            "buyPurchaseRatio": 1,
            "goodsSpecUnifiedCode": "DHwu00030193001",
            "whIdGroups": null,
            "total": 0,
            "totalText": null,
            "totalBuy": 0,
            "totalDly": 0,
            "totalUse": 0,
            "available": 0,
            "availableText": null,
            "availableBuy": 0,
            "availableDly": 0,
            "availableUse": 0,
            "archive": 0,
            "archiveText": null,
            "archiveBuy": 0,
            "archiveDly": 0,
            "archiveUse": 0,
            "quarantine": 0,
            "quarantineText": null,
            "quarantineBuy": 0,
            "quarantineDly": 0,
            "quarantineUse": 0,
            "waitScrap": 0,
            "waitScrapText": null,
            "waitScrapBuy": 0,
            "waitScrapDly": 0,
            "waitScrapUse": 0,
            "scrap": 0,
            "scrapText": null,
            "scrapBuy": 0,
            "scrapDly": 0,
            "scrapUse": 0,
            "stockStatus": null
        },
        {
            "offset": null,
            "pageNo": null,
            "pageSize": null,
            "id": null,
            "warehouseId": null,
            "whName": "821FionaNC仓库2",
            "whCode": "WH2321808002",
            "whStatus": null,
            "cityId": null,
            "goodsId": null,
            "specId": null,
            "createdTime": null,
            "createdTimeQuery": null,
            "goodsStatus": null,
            "specStatus": null,
            "specStatusText": "有效",
            "specName": "tom02采购5000*1桶*冷藏*Yes",
            "specCode": "GS01258-03",
            "goodsName": "tom01货物（根据采购量配货）",
            "brandName": "DHL品牌1",
            "largeClass": null,
            "largeClassName": "DHL大类11",
            "smallClass": null,
            "smallClassName": "DHL小类1",
            "recordMethod": null,
            "buyUnit": null,
            "buyUnitText": "桶",
            "purchaseUnit": null,
            "purchaseUnitText": "桶",
            "useUnit": null,
            "useUnitText": "毫克",
            "purchaseUseRatio": 5000,
            "buyPurchaseRatio": 1,
            "goodsSpecUnifiedCode": "DHwu00030202001",
            "whIdGroups": null,
            "total": 0,
            "totalText": null,
            "totalBuy": 0,
            "totalDly": 0,
            "totalUse": 0,
            "available": 0,
            "availableText": null,
            "availableBuy": 0,
            "availableDly": 0,
            "availableUse": 0,
            "archive": 0,
            "archiveText": null,
            "archiveBuy": 0,
            "archiveDly": 0,
            "archiveUse": 0,
            "quarantine": 0,
            "quarantineText": null,
            "quarantineBuy": 0,
            "quarantineDly": 0,
            "quarantineUse": 0,
            "waitScrap": 0,
            "waitScrapText": null,
            "waitScrapBuy": 0,
            "waitScrapDly": 0,
            "waitScrapUse": 0,
            "scrap": 0,
            "scrapText": null,
            "scrapBuy": 0,
            "scrapDly": 0,
            "scrapUse": 0,
            "stockStatus": null
        },
        {
            "offset": null,
            "pageNo": null,
            "pageSize": null,
            "id": null,
            "warehouseId": null,
            "whName": "821FionaNC仓库2",
            "whCode": "WH2321808002",
            "whStatus": null,
            "cityId": null,
            "goodsId": null,
            "specId": null,
            "createdTime": null,
            "createdTimeQuery": null,
            "goodsStatus": null,
            "specStatus": null,
            "specStatusText": "有效",
            "specName": "tom02采购5000*1桶*冷藏*Yes",
            "specCode": "GS01258-03",
            "goodsName": "tom01货物（根据采购量配货）",
            "brandName": "DHL品牌1",
            "largeClass": null,
            "largeClassName": "DHL大类11",
            "smallClass": null,
            "smallClassName": "DHL小类1",
            "recordMethod": null,
            "buyUnit": null,
            "buyUnitText": "桶",
            "purchaseUnit": null,
            "purchaseUnitText": "桶",
            "useUnit": null,
            "useUnitText": "毫克",
            "purchaseUseRatio": 5000,
            "buyPurchaseRatio": 1,
            "goodsSpecUnifiedCode": "DHwu00030202001",
            "whIdGroups": null,
            "total": 0,
            "totalText": null,
            "totalBuy": 0,
            "totalDly": 0,
            "totalUse": 0,
            "available": 0,
            "availableText": null,
            "availableBuy": 0,
            "availableDly": 0,
            "availableUse": 0,
            "archive": 0,
            "archiveText": null,
            "archiveBuy": 0,
            "archiveDly": 0,
            "archiveUse": 0,
            "quarantine": 0,
            "quarantineText": null,
            "quarantineBuy": 0,
            "quarantineDly": 0,
            "quarantineUse": 0,
            "waitScrap": 0,
            "waitScrapText": null,
            "waitScrapBuy": 0,
            "waitScrapDly": 0,
            "waitScrapUse": 0,
            "scrap": 0,
            "scrapText": null,
            "scrapBuy": 0,
            "scrapDly": 0,
            "scrapUse": 0,
            "stockStatus": null
        },
        {
            "offset": null,
            "pageNo": null,
            "pageSize": null,
            "id": null,
            "warehouseId": null,
            "whName": "821FionaNC仓库2",
            "whCode": "WH2321808002",
            "whStatus": null,
            "cityId": null,
            "goodsId": null,
            "specId": null,
            "createdTime": null,
            "createdTimeQuery": null,
            "goodsStatus": null,
            "specStatus": null,
            "specStatusText": "有效",
            "specName": "tom02采购5000*1桶*冷藏*Yes",
            "specCode": "GS01258-03",
            "goodsName": "tom01货物（根据采购量配货）",
            "brandName": "DHL品牌1",
            "largeClass": null,
            "largeClassName": "DHL大类11",
            "smallClass": null,
            "smallClassName": "DHL小类1",
            "recordMethod": null,
            "buyUnit": null,
            "buyUnitText": "桶",
            "purchaseUnit": null,
            "purchaseUnitText": "桶",
            "useUnit": null,
            "useUnitText": "毫克",
            "purchaseUseRatio": 5000,
            "buyPurchaseRatio": 1,
            "goodsSpecUnifiedCode": "DHwu00030202001",
            "whIdGroups": null,
            "total": 0,
            "totalText": null,
            "totalBuy": 0,
            "totalDly": 0,
            "totalUse": 0,
            "available": 0,
            "availableText": null,
            "availableBuy": 0,
            "availableDly": 0,
            "availableUse": 0,
            "archive": 0,
            "archiveText": null,
            "archiveBuy": 0,
            "archiveDly": 0,
            "archiveUse": 0,
            "quarantine": 0,
            "quarantineText": null,
            "quarantineBuy": 0,
            "quarantineDly": 0,
            "quarantineUse": 0,
            "waitScrap": 0,
            "waitScrapText": null,
            "waitScrapBuy": 0,
            "waitScrapDly": 0,
            "waitScrapUse": 0,
            "scrap": 0,
            "scrapText": null,
            "scrapBuy": 0,
            "scrapDly": 0,
            "scrapUse": 0,
            "stockStatus": null
        },
        {
            "offset": null,
            "pageNo": null,
            "pageSize": null,
            "id": null,
            "warehouseId": null,
            "whName": "821FionaNC仓库2",
            "whCode": "WH2321808002",
            "whStatus": null,
            "cityId": null,
            "goodsId": null,
            "specId": null,
            "createdTime": null,
            "createdTimeQuery": null,
            "goodsStatus": null,
            "specStatus": null,
            "specStatusText": "有效",
            "specName": "tom02采购5000*1桶*冷藏*Yes",
            "specCode": "GS01258-03",
            "goodsName": "tom01货物（根据采购量配货）",
            "brandName": "DHL品牌1",
            "largeClass": null,
            "largeClassName": "DHL大类11",
            "smallClass": null,
            "smallClassName": "DHL小类1",
            "recordMethod": null,
            "buyUnit": null,
            "buyUnitText": "桶",
            "purchaseUnit": null,
            "purchaseUnitText": "桶",
            "useUnit": null,
            "useUnitText": "毫克",
            "purchaseUseRatio": 5000,
            "buyPurchaseRatio": 1,
            "goodsSpecUnifiedCode": "DHwu00030202001",
            "whIdGroups": null,
            "total": 0,
            "totalText": null,
            "totalBuy": 0,
            "totalDly": 0,
            "totalUse": 0,
            "available": 0,
            "availableText": null,
            "availableBuy": 0,
            "availableDly": 0,
            "availableUse": 0,
            "archive": 0,
            "archiveText": null,
            "archiveBuy": 0,
            "archiveDly": 0,
            "archiveUse": 0,
            "quarantine": 0,
            "quarantineText": null,
            "quarantineBuy": 0,
            "quarantineDly": 0,
            "quarantineUse": 0,
            "waitScrap": 0,
            "waitScrapText": null,
            "waitScrapBuy": 0,
            "waitScrapDly": 0,
            "waitScrapUse": 0,
            "scrap": 0,
            "scrapText": null,
            "scrapBuy": 0,
            "scrapDly": 0,
            "scrapUse": 0,
            "stockStatus": null
        },
        {
            "offset": null,
            "pageNo": null,
            "pageSize": null,
            "id": null,
            "warehouseId": null,
            "whName": "821FionaNC仓库2",
            "whCode": "WH2321808002",
            "whStatus": null,
            "cityId": null,
            "goodsId": null,
            "specId": null,
            "createdTime": null,
            "createdTimeQuery": null,
            "goodsStatus": null,
            "specStatus": null,
            "specStatusText": "有效",
            "specName": "tom02采购5000*1桶*冷藏*Yes",
            "specCode": "GS01258-03",
            "goodsName": "tom01货物（根据采购量配货）",
            "brandName": "DHL品牌1",
            "largeClass": null,
            "largeClassName": "DHL大类11",
            "smallClass": null,
            "smallClassName": "DHL小类1",
            "recordMethod": null,
            "buyUnit": null,
            "buyUnitText": "桶",
            "purchaseUnit": null,
            "purchaseUnitText": "桶",
            "useUnit": null,
            "useUnitText": "毫克",
            "purchaseUseRatio": 5000,
            "buyPurchaseRatio": 1,
            "goodsSpecUnifiedCode": "DHwu00030202001",
            "whIdGroups": null,
            "total": 0,
            "totalText": null,
            "totalBuy": 0,
            "totalDly": 0,
            "totalUse": 0,
            "available": 0,
            "availableText": null,
            "availableBuy": 0,
            "availableDly": 0,
            "availableUse": 0,
            "archive": 0,
            "archiveText": null,
            "archiveBuy": 0,
            "archiveDly": 0,
            "archiveUse": 0,
            "quarantine": 0,
            "quarantineText": null,
            "quarantineBuy": 0,
            "quarantineDly": 0,
            "quarantineUse": 0,
            "waitScrap": 0,
            "waitScrapText": null,
            "waitScrapBuy": 0,
            "waitScrapDly": 0,
            "waitScrapUse": 0,
            "scrap": 0,
            "scrapText": null,
            "scrapBuy": 0,
            "scrapDly": 0,
            "scrapUse": 0,
            "stockStatus": null
        },
        {
            "offset": null,
            "pageNo": null,
            "pageSize": null,
            "id": null,
            "warehouseId": null,
            "whName": "821FionaNC仓库2",
            "whCode": "WH2321808002",
            "whStatus": null,
            "cityId": null,
            "goodsId": null,
            "specId": null,
            "createdTime": null,
            "createdTimeQuery": null,
            "goodsStatus": null,
            "specStatus": null,
            "specStatusText": "有效",
            "specName": "tom02采购5000*1桶*冷藏*Yes",
            "specCode": "GS01258-03",
            "goodsName": "tom01货物（根据采购量配货）",
            "brandName": "DHL品牌1",
            "largeClass": null,
            "largeClassName": "DHL大类11",
            "smallClass": null,
            "smallClassName": "DHL小类1",
            "recordMethod": null,
            "buyUnit": null,
            "buyUnitText": "桶",
            "purchaseUnit": null,
            "purchaseUnitText": "桶",
            "useUnit": null,
            "useUnitText": "毫克",
            "purchaseUseRatio": 5000,
            "buyPurchaseRatio": 1,
            "goodsSpecUnifiedCode": "DHwu00030202001",
            "whIdGroups": null,
            "total": 0,
            "totalText": null,
            "totalBuy": 0,
            "totalDly": 0,
            "totalUse": 0,
            "available": 0,
            "availableText": null,
            "availableBuy": 0,
            "availableDly": 0,
            "availableUse": 0,
            "archive": 0,
            "archiveText": null,
            "archiveBuy": 0,
            "archiveDly": 0,
            "archiveUse": 0,
            "quarantine": 0,
            "quarantineText": null,
            "quarantineBuy": 0,
            "quarantineDly": 0,
            "quarantineUse": 0,
            "waitScrap": 0,
            "waitScrapText": null,
            "waitScrapBuy": 0,
            "waitScrapDly": 0,
            "waitScrapUse": 0,
            "scrap": 0,
            "scrapText": null,
            "scrapBuy": 0,
            "scrapDly": 0,
            "scrapUse": 0,
            "stockStatus": null
        },
        {
            "offset": null,
            "pageNo": null,
            "pageSize": null,
            "id": null,
            "warehouseId": null,
            "whName": "821FionaNC仓库2",
            "whCode": "WH2321808002",
            "whStatus": null,
            "cityId": null,
            "goodsId": null,
            "specId": null,
            "createdTime": null,
            "createdTimeQuery": null,
            "goodsStatus": null,
            "specStatus": null,
            "specStatusText": "有效",
            "specName": "tom02采购1万*1件*常温*Yes",
            "specCode": "GS01258-02",
            "goodsName": "tom01货物（根据采购量配货）",
            "brandName": "Evan品牌",
            "largeClass": null,
            "largeClassName": "DHL大类11",
            "smallClass": null,
            "smallClassName": "DHL小类1",
            "recordMethod": null,
            "buyUnit": null,
            "buyUnitText": "件",
            "purchaseUnit": null,
            "purchaseUnitText": "件",
            "useUnit": null,
            "useUnitText": "毫克",
            "purchaseUseRatio": 10000,
            "buyPurchaseRatio": 1,
            "goodsSpecUnifiedCode": "DHwu00030193002",
            "whIdGroups": null,
            "total": 0,
            "totalText": null,
            "totalBuy": 0,
            "totalDly": 0,
            "totalUse": 0,
            "available": 0,
            "availableText": null,
            "availableBuy": 0,
            "availableDly": 0,
            "availableUse": 0,
            "archive": 0,
            "archiveText": null,
            "archiveBuy": 0,
            "archiveDly": 0,
            "archiveUse": 0,
            "quarantine": 0,
            "quarantineText": null,
            "quarantineBuy": 0,
            "quarantineDly": 0,
            "quarantineUse": 0,
            "waitScrap": 0,
            "waitScrapText": null,
            "waitScrapBuy": 0,
            "waitScrapDly": 0,
            "waitScrapUse": 0,
            "scrap": 0,
            "scrapText": null,
            "scrapBuy": 0,
            "scrapDly": 0,
            "scrapUse": 0,
            "stockStatus": null
        },
        {
            "offset": null,
            "pageNo": null,
            "pageSize": null,
            "id": null,
            "warehouseId": null,
            "whName": "821FionaNC仓库2",
            "whCode": "WH2321808002",
            "whStatus": null,
            "cityId": null,
            "goodsId": null,
            "specId": null,
            "createdTime": null,
            "createdTimeQuery": null,
            "goodsStatus": null,
            "specStatus": null,
            "specStatusText": "有效",
            "specName": "tom02采购5000*1桶*冷藏*Yes",
            "specCode": "GS01258-03",
            "goodsName": "tom01货物（根据采购量配货）",
            "brandName": "DHL品牌1",
            "largeClass": null,
            "largeClassName": "DHL大类11",
            "smallClass": null,
            "smallClassName": "DHL小类1",
            "recordMethod": null,
            "buyUnit": null,
            "buyUnitText": "桶",
            "purchaseUnit": null,
            "purchaseUnitText": "桶",
            "useUnit": null,
            "useUnitText": "毫克",
            "purchaseUseRatio": 5000,
            "buyPurchaseRatio": 1,
            "goodsSpecUnifiedCode": "DHwu00030202001",
            "whIdGroups": null,
            "total": 0,
            "totalText": null,
            "totalBuy": 0,
            "totalDly": 0,
            "totalUse": 0,
            "available": 0,
            "availableText": null,
            "availableBuy": 0,
            "availableDly": 0,
            "availableUse": 0,
            "archive": 0,
            "archiveText": null,
            "archiveBuy": 0,
            "archiveDly": 0,
            "archiveUse": 0,
            "quarantine": 0,
            "quarantineText": null,
            "quarantineBuy": 0,
            "quarantineDly": 0,
            "quarantineUse": 0,
            "waitScrap": 0,
            "waitScrapText": null,
            "waitScrapBuy": 0,
            "waitScrapDly": 0,
            "waitScrapUse": 0,
            "scrap": 0,
            "scrapText": null,
            "scrapBuy": 0,
            "scrapDly": 0,
            "scrapUse": 0,
            "stockStatus": null
        }
    ];

    var styleBgYellow = {
        "fill": {
            "fgColor": {
                "rgb": "ffff00"
            }
        },
        "border": {
            "top": {
                "style": "thin"
            },
            "left": {
                "style": "thin"
            },
            "right": {
                "style": "thin"
            },
            "bottom": {
                "style": "thin"
            }
        }
    };

    var styleCell = {
        "alignment": {
            "horizontal": "center",
            "vertical": "center"
        }
    }

    var excelHelper = new ExcelHelper({
        fileName: "导出测试",
        xlsxOptions: {
            defaultCellStyle: {
                "font": {},
                "border": {
                    "top": {
                        "style": "thin"
                    },
                    "left": {
                        "style": "thin"
                    },
                    "right": {
                        "style": "thin"
                    },
                    "bottom": {
                        "style": "thin"
                    }
                },
                "alignment": {
                    "horizontal": "center",
                    "vertical": "center"
                }
            }
        },
        autoWidth: true,

        // headerStyle: [
        //     "color:blue;",
        //     "color:green;background-color:yellow;"
        // ],
        tableStyle: "td{text-align: center;}",
        // tableStyle: "table,th,td{text-align: right;color:red;}",
        // tablePreviewStyle: "table {border-collapse: collapse;color:red;}table, td, th {border: 1px solid black;}",
        header: [
            [
                {
                    title: '仓库编号', rowspan: 2, width: 50, style: styleBgYellow
                },
                {title: '仓库名称', rowspan: 2, width: 50, style: styleBgYellow},
                {title: '货物规格编号', rowspan: 2, width: 50, style: styleBgYellow},
                {title: '货物规格统一编码', rowspan: 2, style: styleBgYellow},
                {title: '货物规格名称', rowspan: 2, style: styleBgYellow},
                {title: '规格品牌', rowspan: 2, style: styleBgYellow},
                {title: '货物规格状态', rowspan: 2, style: styleBgYellow},
                {title: '货物大类', rowspan: 2, style: styleBgYellow},
                {title: '货物小类', rowspan: 2, style: styleBgYellow},

                {title: '总库存', colspan: 6, style: styleBgYellow},
                {style: styleBgYellow},
                {style: styleBgYellow},
                {style: styleBgYellow},
                {style: styleBgYellow},
                {style: styleBgYellow},

                {title: '可用库存', colspan: 6, style: styleBgYellow},
                {style: styleBgYellow},
                {style: styleBgYellow},
                {style: styleBgYellow},
                {style: styleBgYellow},
                {style: styleBgYellow},

                {title: '封存库存', colspan: 6, style: styleBgYellow},
                {style: styleBgYellow},
                {style: styleBgYellow},
                {style: styleBgYellow},
                {style: styleBgYellow},
                {style: styleBgYellow},

                {title: '待检库存', colspan: 6, style: styleBgYellow},
                {style: styleBgYellow},
                {style: styleBgYellow},
                {style: styleBgYellow},
                {style: styleBgYellow},
                {style: styleBgYellow},

                {title: '待报废库存', colspan: 6, style: styleBgYellow},
                {style: styleBgYellow},
                {style: styleBgYellow},
                {style: styleBgYellow},
                {style: styleBgYellow},
                {style: styleBgYellow},

                {title: '废品库存', colspan: 6, style: styleBgYellow},
                {style: styleBgYellow},
                {style: styleBgYellow},
                {style: styleBgYellow},
                {style: styleBgYellow},
                {style: styleBgYellow},
            ],
            [
                {style: styleBgYellow},
                {style: styleBgYellow},
                {style: styleBgYellow},
                {style: styleBgYellow},
                {style: styleBgYellow},
                {style: styleBgYellow},
                {style: styleBgYellow},
                {style: styleBgYellow},
                {style: styleBgYellow},

                {title: '数量', style: styleBgYellow},
                {title: '采购单位', style: styleBgYellow},
                {title: '数量', style: styleBgYellow},
                {title: '配货单位', style: styleBgYellow},
                {title: '数量', style: styleBgYellow},
                {title: '用料单位', style: styleBgYellow},

                {title: '数量', style: styleBgYellow},
                {title: '采购单位', style: styleBgYellow},
                {title: '数量', style: styleBgYellow},
                {title: '配货单位', style: styleBgYellow},
                {title: '数量', style: styleBgYellow},
                {title: '用料单位', style: styleBgYellow},

                {title: '数量', style: styleBgYellow},
                {title: '采购单位', style: styleBgYellow},
                {title: '数量', style: styleBgYellow},
                {title: '配货单位', style: styleBgYellow},
                {title: '数量', style: styleBgYellow},
                {title: '用料单位', style: styleBgYellow},

                {title: '数量', style: styleBgYellow},
                {title: '采购单位', style: styleBgYellow},
                {title: '数量', style: styleBgYellow},
                {title: '配货单位', style: styleBgYellow},
                {title: '数量', style: styleBgYellow},
                {title: '用料单位', style: styleBgYellow},

                {title: '数量', style: styleBgYellow},
                {title: '采购单位', style: styleBgYellow},
                {title: '数量', style: styleBgYellow},
                {title: '配货单位', style: styleBgYellow},
                {title: '数量', style: styleBgYellow},
                {title: '用料单位', style: styleBgYellow},

                {title: '数量', style: styleBgYellow},
                {title: '采购单位', style: styleBgYellow},
                {title: '数量', style: styleBgYellow},
                {title: '配货单位', style: styleBgYellow},
                {title: '数量', style: styleBgYellow},
                {title: '用料单位', style: styleBgYellow}
            ]
        ],

        columns: [
            {
                title: '仓库编号', dataIndex: 'whCode', style: styleCell,
                renderer: function (value, obj) {
                    return value;
                }
            },
            {title: '仓库名称', dataIndex: 'whName'},
            {title: '货物规格编号', dataIndex: 'specCode'},
            {title: '货物规格统一编码', dataIndex: 'goodsSpecUnifiedCode'/*, 'mso-number-format':'\\@'*/},
            {title: '货物规格名称', dataIndex: 'specName'},
            {title: '规格品牌', dataIndex: 'brandName'},
            {title: '货物规格状态', dataIndex: 'specStatusText'},
            {title: '货物大类', dataIndex: 'largeClassName'},
            {title: '货物小类', dataIndex: 'smallClassName'},

            {title: '数量', dataIndex: 'totalBuy', type: "n"},
            {title: '采购单位', dataIndex: 'buyUnitText'},
            {title: '数量', dataIndex: 'totalDly', type: "n"},
            {title: '配货单位', dataIndex: 'purchaseUnitText'},
            {title: '数量', dataIndex: 'totalUse', type: "n"},
            {title: '用料单位', dataIndex: 'useUnitText'},

            {title: '数量', dataIndex: 'availableBuy', type: "n"},
            {title: '采购单位', dataIndex: 'buyUnitText'},
            {title: '数量', dataIndex: 'availableDly', type: "n"},
            {title: '配货单位', dataIndex: 'purchaseUnitText'},
            {title: '数量', dataIndex: 'availableUse', type: "n"},
            {title: '用料单位', dataIndex: 'useUnitText'},

            {title: '数量', dataIndex: 'archiveBuy', type: "n"},
            {title: '采购单位', dataIndex: 'buyUnitText'},
            {title: '数量', dataIndex: 'archiveDly', type: "n"},
            {title: '配货单位', dataIndex: 'purchaseUnitText'},
            {title: '数量', dataIndex: 'archiveUse', type: "n"},
            {title: '用料单位', dataIndex: 'useUnitText'},

            {title: '数量', dataIndex: 'quarantineBuy', type: "n"},
            {title: '采购单位', dataIndex: 'buyUnitText'},
            {title: '数量', dataIndex: 'quarantineDly', type: "n"},
            {title: '配货单位', dataIndex: 'purchaseUnitText'},
            {title: '数量', dataIndex: 'quarantineUse', type: "n"},
            {title: '用料单位', dataIndex: 'useUnitText'},

            {title: '数量', dataIndex: 'waitScrapBuy', type: "n"},
            {title: '采购单位', dataIndex: 'buyUnitText'},
            {title: '数量', dataIndex: 'waitScrapDly', type: "n"},
            {title: '配货单位', dataIndex: 'purchaseUnitText'},
            {title: '数量', dataIndex: 'waitScrapUse', type: "n"},
            {title: '用料单位', dataIndex: 'useUnitText'},

            {title: '数量', dataIndex: 'scrapBuy', type: "n"},
            {title: '采购单位', dataIndex: 'buyUnitText'},
            {title: '数量', dataIndex: 'scrapDly', type: "n"},
            {title: '配货单位', dataIndex: 'purchaseUnitText'},
            {title: '数量', dataIndex: 'scrapUse', type: "n"},
            {title: '用料单位', dataIndex: 'useUnitText'}
        ],
        // data: data,
        ajax: {
            url: '${request.contextPath}/warehousestock/export',
            method: 'POST',
            data: {
                // id: "229659"
            },
            pageSize: 10,
            initialPageNo: 1,//注意 常用的为0
            pageSizeKey: "size",
            pageNoKey: "page",
            // 成功回调函数，这里可以做一下数据处理工作。如有设置，请必须返回处理后的值
            success: function (result) {
                return result.data.rows;
            }
        },
        maxRow: 20,
        previewEl: "previewDiv",
        testRepeat: 0,
        doExport: true
    });

    var str = '{"A1":{"t":"s","v":"JK香蕉核桃麦芬3个/盒*8盒/箱（仓配\计算）供应商-不标"},"B1":{"t":"s","v":"仓库名称"},"C1":{"t":"s","v":"货物规格编号"},"D1":{"t":"s","v":"货物规格统一编码"},"E1":{"t":"s","v":"货物规格名称"},"F1":{"t":"s","v":"规格品牌"},"G1":{"t":"s","v":"货物规格状态"},"H1":{"t":"s","v":"货物大类"},"I1":{"t":"s","v":"货物小类"},"J1":{"t":"s","v":"总库存"},"K1":{"t":"s","v":"undefined"},"L1":{"t":"s","v":"undefined"},"M1":{"t":"s","v":"undefined"},"N1":{"t":"s","v":"undefined"},"O1":{"t":"s","v":"undefined"},"P1":{"t":"s","v":"可用库存"},"Q1":{"t":"s","v":"undefined"},"R1":{"t":"s","v":"undefined"},"S1":{"t":"s","v":"undefined"},"T1":{"t":"s","v":"undefined"},"U1":{"t":"s","v":"undefined"},"V1":{"t":"s","v":"封存库存"},"W1":{"t":"s","v":"undefined"},"X1":{"t":"s","v":"undefined"},"Y1":{"t":"s","v":"undefined"},"Z1":{"t":"s","v":"undefined"},"AA1":{"t":"s","v":"undefined"},"AB1":{"t":"s","v":"待检库存"},"AC1":{"t":"s","v":"undefined"},"AD1":{"t":"s","v":"undefined"},"AE1":{"t":"s","v":"undefined"},"AF1":{"t":"s","v":"undefined"},"AG1":{"t":"s","v":"undefined"},"AH1":{"t":"s","v":"待报废库存"},"AI1":{"t":"s","v":"undefined"},"AJ1":{"t":"s","v":"undefined"},"AK1":{"t":"s","v":"undefined"},"AL1":{"t":"s","v":"undefined"},"AM1":{"t":"s","v":"undefined"},"AN1":{"t":"s","v":"废品库存"},"AO1":{"t":"s","v":"undefined"},"AP1":{"t":"s","v":"undefined"},"AQ1":{"t":"s","v":"undefined"},"AR1":{"t":"s","v":"undefined"},"AS1":{"t":"s","v":"undefined"},"A2":{"t":"s","v":"undefined"},"B2":{"t":"s","v":"undefined"},"C2":{"t":"s","v":"undefined"},"D2":{"t":"s","v":"undefined"},"E2":{"t":"s","v":"undefined"},"F2":{"t":"s","v":"undefined"},"G2":{"t":"s","v":"undefined"},"H2":{"t":"s","v":"undefined"},"I2":{"t":"s","v":"undefined"},"J2":{"t":"s","v":"数量"},"K2":{"t":"s","v":"采购单位"},"L2":{"t":"s","v":"数量"},"M2":{"t":"s","v":"配货单位"},"N2":{"t":"s","v":"数量"},"O2":{"t":"s","v":"用料单位"},"P2":{"t":"s","v":"数量"},"Q2":{"t":"s","v":"采购单位"},"R2":{"t":"s","v":"数量"},"S2":{"t":"s","v":"配货单位"},"T2":{"t":"s","v":"数量"},"U2":{"t":"s","v":"用料单位"},"V2":{"t":"s","v":"数量"},"W2":{"t":"s","v":"采购单位"},"X2":{"t":"s","v":"数量"},"Y2":{"t":"s","v":"配货单位"},"Z2":{"t":"s","v":"数量"},"AA2":{"t":"s","v":"用料单位"},"AB2":{"t":"s","v":"数量"},"AC2":{"t":"s","v":"采购单位"},"AD2":{"t":"s","v":"数量"},"AE2":{"t":"s","v":"配货单位"},"AF2":{"t":"s","v":"数量"},"AG2":{"t":"s","v":"用料单位"},"AH2":{"t":"s","v":"数量"},"AI2":{"t":"s","v":"采购单位"},"AJ2":{"t":"s","v":"数量"},"AK2":{"t":"s","v":"配货单位"},"AL2":{"t":"s","v":"数量"},"AM2":{"t":"s","v":"用料单位"},"AN2":{"t":"s","v":"数量"},"AO2":{"t":"s","v":"采购单位"},"AP2":{"t":"s","v":"数量"},"AQ2":{"t":"s","v":"配货单位"},"AR2":{"t":"s","v":"数量"},"AS2":{"t":"s","v":"用料单位"}}';
    str = str.replace(/\\/g, '\\\\');
    var strObj = JSON.parse(str);
    // var strObj1 = eval(str);

    var exportExcel = function () {
        // excelHelper.collectColWidth(0,0, "tom02采购5000*1桶*冷藏*Yes")
        excelHelper.export();
    };

    var test = function () {
        var as = ExcelHelper.utils.indexToLetter(25);
        console.log("as:%o", as);
    }

</script>
</body>
</html>
